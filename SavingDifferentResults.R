unique(round(prices_pc,5))[,1:5]
#         [,1]    [,2]    [,3]    [,4]    [,5]
# [1,] 0.55150 0.49750 0.54333 0.53217 0.54458
# [2,] 0.25908 0.20508 0.25092 0.23975 0.25217

unique(round(prices_ps,5))[,1:5]
#         [,1]    [,2]    [,3]    [,4]    [,5]
# [1,] 0.86866 0.83604 0.86709 0.85292 0.86826
# [2,] 0.91514 0.87628 0.90865 0.90323 0.90971
# [3,] 1.03175 1.00733 1.04458 1.00617 1.04375
# [4,] 0.85248 0.83894 0.85616 0.84837 0.85664
# [5,] 0.91285 0.87300 0.90630 0.89740 0.90730
# [6,] 0.83949 0.81799 0.83618 0.83222 0.83652
# [7,] 0.90708 0.86543 0.90154 0.89305 0.90247
# [8,] 0.65568 0.78435 0.71504 0.80776 0.66273
# [9,] 0.89544 0.85947 0.88918 0.87541 0.88687
# [10,] 1.02810 1.00733 1.02987 1.00617 1.03498
# [11,] 0.62336 0.60155 0.61915 0.61157 0.61673
# [12,] 0.86146 0.84121 0.85760 0.85287 0.85791
# [13,] 0.99907 0.99881 1.00087 0.99690 1.00499
# [14,] 0.60254 0.57610 0.60109 0.59693 0.59542
# [15,] 0.84555 0.84049 0.84224 0.83668 0.84245
# [16,] 0.98108 0.97669 0.98143 0.97572 0.98481
# [17,] 0.59394 0.56969 0.58961 0.58372 0.58541
# [18,] 0.84210 0.83770 0.83766 0.83142 0.83816
# [19,] 0.97044 0.96395 0.96964 0.96492 0.97215

unique(round(expected_PS,5))[,1:5]
#         [,1]    [,2]    [,3]    [,4]    [,5]
# [1,] 2.44332 2.36534 2.43947 2.40450 2.44235
# [2,] 2.55801 2.46213 2.54189 2.52864 2.54463
# [3,] 2.84574 2.78550 2.87741 2.78262 2.87535
# [4,] 2.40408 2.37707 2.41249 2.39326 2.41370
# [5,] 2.55236 2.45403 2.53620 2.51424 2.53867
# [6,] 2.37146 2.31832 2.36334 2.35346 2.36412
# [7,] 2.53806 2.43535 2.52444 2.50350 2.52675
# [8,] 1.93047 2.23562 2.07587 2.29227 1.95131
# [9,] 2.51574 2.42066 2.49837 2.46141 2.49204
# [10,] 2.83158 2.78550 2.83638 2.78262 2.84992
# [11,] 1.84105 1.79531 1.83207 1.81378 1.82357
# [12,] 2.42557 2.37776 2.41624 2.40403 2.41687
# [13,] 2.76141 2.76028 2.76565 2.75505 2.77629
# [14,] 1.79266 1.72526 1.79060 1.78131 1.77382
# [15,] 2.38639 2.38098 2.37845 2.36441 2.37882
# [16,] 2.71747 2.70587 2.71963 2.70457 2.72832
# [17,] 1.77086 1.70800 1.76058 1.74655 1.74783
# [18,] 2.37786 2.37689 2.36703 2.35146 2.36817
# [19,] 2.69303 2.67500 2.69042 2.67716 2.69675

ps_lo <- ps  - 0.1
pc_lo <- pc  - 0.1
ps_expected_lo <- ps_expected - 0.1

ps_up <- ps  + 0.37750
pc_up <- pc  + 0.192417
ps_expected_up <- ps_expected + 0.3

#### THE ABOVE ARE WITH EXPECTED PRICE MOVING WITH THE PS AND PC #####

#### THE BELOW ARE THE EXPECTED PRICE CONSTANT WITH PS AND PC MOVING #####

unique(round(expected_PS,5))[,1:5]
#         [,1]    [,2]    [,3]    [,4]    [,5]
# [1,] 2.20780 2.11783 2.20730 2.18763 2.18568
# [2,] 2.30066 2.25410 2.28772 2.27083 2.28966
# [3,] 2.54574 2.48550 2.57741 2.48262 2.57535
# [4,] 2.20212 2.11195 2.20026 2.17169 2.19996
# [5,] 2.29087 2.20686 2.27571 2.25616 2.27798
# [6,] 2.13865 2.09367 2.13525 2.09884 2.13798
# [7,] 2.27213 2.17626 2.25288 2.24277 2.25557
# [8,] 2.07960 2.07122 2.10996 2.05786 2.11257
# [9,] 2.25784 2.14871 2.24205 2.22009 2.24448
# [10,] 1.63643 1.96419 1.64772 1.99377 1.62290
# [11,] 2.21601 2.13732 2.19562 2.19831 2.19879
# [12,] 1.56089 1.92505 1.54119 1.56335 1.53937
# [13,] 2.21742 2.11874 2.20093 2.18047 2.20162
# [14,] 2.54224 2.48550 2.56303 2.48262 2.56610
# [15,] 1.54342 1.92153 1.52423 1.52486 1.52545
# [16,] 2.21715 2.09422 2.18805 2.16429 2.20345
# [17,] 2.51030 2.47568 2.53021 2.48262 2.53332
# [18,] 2.20214 2.11195 2.20026 2.17169 2.19996
# [19,] 2.20213 2.11195 2.20026 2.17169 2.19996


unique(round(prices_ps,5))[,1:5]
#         [,1]    [,2]    [,3]    [,4]    [,5]
# [1,] 0.89430 0.85833 0.89459 0.88662 0.88582
# [2,] 0.93243 0.91394 0.92718 0.92039 0.92797
# [3,] 1.03175 1.00733 1.04458 1.00617 1.04375
# [4,] 0.89024 0.85594 0.89028 0.87968 0.89004
# [5,] 0.92845 0.89455 0.92231 0.91440 0.92323
# [6,] 0.86676 0.84775 0.86539 0.85060 0.86649
# [7,] 0.92086 0.88201 0.91306 0.90896 0.91458
# [8,] 0.84279 0.84567 0.85514 0.83402 0.85619
# [9,] 0.91507 0.87084 0.90867 0.89977 0.90965
# [10,] 0.65869 0.79596 0.66220 0.80801 0.65339
# [11,] 0.89740 0.86622 0.88973 0.89101 0.89092
# [12,] 0.63124 0.78016 0.62367 0.62963 0.62330
# [13,] 0.89631 0.85874 0.89024 0.88214 0.89040
# [14,] 1.03175 1.00733 1.04017 1.00617 1.04135
# [15,] 0.62475 0.77876 0.61734 0.61573 0.61794
# [16,] 0.89508 0.84838 0.88374 0.87487 0.89002
# [17,] 1.01909 1.00573 1.02687 1.00617 1.02806
# [18,] 0.89025 0.85594 0.89028 0.87968 0.89004

unique(round(prices_pc,5))[,1:5]
#         [,1]    [,2]    [,3]    [,4]    [,5]
# [1,] 0.55150 0.49750 0.54333 0.53217 0.54458
# [2,] 0.25908 0.20508 0.25092 0.23975 0.25217

###### NOW I CHANGE THE INTERVAL of PS BUT WITH EVERYTHING MOVING i.e., PS, PC, EXPECTED PS #####

unique(round(prices_ps,5))[,1:5]
#         [,1]    [,2]    [,3]    [,4]    [,5]
# [1,] 0.73221 0.68329 0.72325 0.71416 0.72994
# [2,] 0.76354 0.73912 0.77637 0.73796 0.77554
# [3,] 0.73656 0.68823 0.72905 0.72021 0.73385
# [4,] 0.76354 0.73912 0.77637 0.73796 0.77464
# [5,] 0.74344 0.68821 0.73288 0.72729 0.73330
# [6,] 0.75257 0.73791 0.75578 0.73753 0.75657
# [7,] 0.72486 0.69719 0.72123 0.71660 0.71979
# [8,] 0.75910 0.73912 0.74545 0.73207 0.74355
# [9,] 0.65488 0.66087 0.65315 0.64912 0.64899
# [10,] 0.76035 0.70395 0.74958 0.73796 0.75204
# [11,] 0.64050 0.60579 0.63236 0.62661 0.63033
# [12,] 0.76354 0.71194 0.75738 0.73796 0.75708
# [13,] 0.63293 0.59742 0.62556 0.61848 0.62468
# [14,] 0.75071 0.71230 0.75047 0.73796 0.74968

unique(round(prices_pc,5))[,1:5]
#         [,1]    [,2]    [,3]    [,4]    [,5]
# [1,] 0.55150 0.49750 0.54333 0.53217 0.54458
# [2,] 0.25908 0.20508 0.25092 0.23975 0.25217

unique(round(expected_PS,5))[,1:5]
#         [,1]    [,2]    [,3]    [,4]    [,5]
# [1,] 1.81500 1.68782 1.79129 1.76790 1.81023
# [2,] 1.88396 1.82371 1.91562 1.82084 1.91357
# [3,] 1.83099 1.70591 1.81149 1.78893 1.79571
# [4,] 1.88396 1.82371 1.91562 1.82084 1.91149
# [5,] 1.82965 1.71176 1.80182 1.78670 1.80296
# [6,] 1.85797 1.82224 1.86523 1.81982 1.86699
# [7,] 1.79157 1.71765 1.78178 1.76934 1.77811
# [8,] 1.85530 1.81833 1.84567 1.81057 1.84015
# [9,] 1.62566 1.64582 1.62249 1.61328 1.61048
# [10,] 1.86812 1.74450 1.86215 1.82084 1.84643
# [11,] 1.58919 1.50374 1.56782 1.55456 1.56122
# [12,] 1.88396 1.74870 1.86716 1.82084 1.86641
# [13,] 1.56921 1.48267 1.55014 1.53327 1.54684
# [14,] 1.85396 1.75340 1.85294 1.82084 1.85097

ps_lo <- ps  - 0.05
pc_lo <- pc  - 0.1
# ps_expected_lo <- ps_expected - 0.1

ps_up <- ps  + 0.10929
pc_up <- pc  + 0.192417

##### NOW THE SAME ABOVE BUT USE ALL THE PAST PRICES ######

unique(round(expected_PS,5))[,1:5]
#         [,1]    [,2]    [,3]    [,4]    [,5]
# [1,] 1.81500 1.68782 1.76562 1.75233 1.78500
# [2,] 1.88396 1.82371 1.87443 1.85339 1.88334
# [3,] 1.88396 1.82371 1.87443 1.85339 1.88334
# [4,] 1.83099 1.70591 1.78009 1.75681 1.80622
# [5,] 1.88396 1.82371 1.87443 1.85339 1.88334
# [6,] 1.82965 1.71176 1.78684 1.76995 1.80276
# [7,] 1.85797 1.82224 1.83983 1.82898 1.85763
# [8,] 1.79157 1.71765 1.76652 1.76378 1.78165
# [9,] 1.85530 1.81833 1.81875 1.80393 1.83358
# [10,] 1.62566 1.64582 1.58697 1.62627 1.61356
# [11,] 1.86812 1.74450 1.82679 1.81200 1.85013
# [12,] 1.58919 1.50374 1.53437 1.56454 1.56971
# [13,] 1.88396 1.74870 1.84122 1.81606 1.86180
# [14,] 1.56921 1.48267 1.51787 1.53868 1.54855
# [15,] 1.85396 1.75340 1.83925 1.82470 1.84817

unique(round(prices_ps,5))[,1:5]
#         [,1]    [,2]    [,3]    [,4]    [,5]
# [1,] 0.73221 0.68329 0.71325 0.70807 0.72078
# [2,] 0.76354 0.73912 0.75968 0.75115 0.76329
# [3,] 0.76354 0.73912 0.75968 0.75115 0.76329
# [4,] 0.73656 0.68823 0.71702 0.70834 0.72693
# [5,] 0.76354 0.73912 0.75968 0.75115 0.76329
# [6,] 0.74344 0.68821 0.71735 0.71088 0.73331
# [7,] 0.75257 0.73791 0.74556 0.74107 0.75281
# [8,] 0.72486 0.69719 0.71553 0.71456 0.72123
# [9,] 0.75910 0.73912 0.73491 0.72914 0.74088
# [10,] 0.65488 0.66087 0.63963 0.65340 0.64974
# [11,] 0.76035 0.70395 0.73593 0.73016 0.74499
# [12,] 0.64050 0.60579 0.61964 0.62938 0.63261
# [13,] 0.76354 0.71194 0.73992 0.73778 0.75533
# [14,] 0.63293 0.59742 0.61326 0.61939 0.62457
# [15,] 0.75071 0.71230 0.74529 0.73971 0.74866

unique(round(prices_pc,5))[,1:5]
#         [,1]    [,2]    [,3]    [,4]    [,5]
# [1,] 0.55150 0.49750 0.53078 0.52433 0.54003
# [2,] 0.25908 0.20508 0.23836 0.23192 0.24761


###### NOW I CHANGE THE INTERVAL FOR PC #####

unique(round(prices_pc,5))[,1:7]



















