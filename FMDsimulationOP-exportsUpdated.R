
##### 20% depopulation rate

# Case III : depop K1, change capA - equillibrium simulation continues

# proj_Q_P_PostFMD
#     Year        Ps        Pc       EPs       EPc        Hc       Sl       Cl        A   repHeif repHeif_Head
# 1  2010 0.6011694 0.5845779 1.3906614 0.7194778 0.5072427 20.53728 1.015221 21.66571 0.3619544     427294.9
# 2  2011 0.6178396 0.5737343 1.3925122 0.7067025 0.5072477 19.36640 1.016800 20.49014 1.3029806    1538196.5
# 3  2012 0.6829699 0.4498377 1.4054155 0.5682568 0.5072477 19.01773 1.016471 21.19644 1.5865637    1872972.3
# 4  2013 0.7005985 0.4788351 1.3919812 0.6103518 0.5072443 19.01591 1.012497 21.11473 0.1475194     174149.8
# 5  2014 0.7093559 0.4865741 1.3906306 0.6195163 0.5072476 19.01868 1.015855 21.11773 0.7504100     885875.0
# 6  2015 0.7120124 0.4423569 1.3606462 0.6023321 0.5072484 19.01300 1.170720 21.29100 2.2271320    2629176.9
# 7  2016 0.7136225 0.3003436 1.2945933 0.5189507 0.5072471 19.01231 1.752258 21.88619 2.9315186    3460720.5
# 8  2017 0.9244191 0.4450128 0.9614512 0.9769558 0.5072585 19.01050 2.076779 22.25947 3.2954023    3890292.9
# 9  2018 1.0054538 0.5060416 0.6838519 1.2978097 0.5072484 19.01043 2.193675 22.35825 3.3711587    3979724.9
# 10 2019 1.0423835 0.6323620 0.3633883 1.7252474 0.5072481 19.01269 1.736493 21.87019 2.7004518    3187941.1
# > beefINV_FORECAST_PostFMD
#     Year        K        k3        k4        k5        k6        k7        k8      k9 k10
# 1  2010 25151920 4440160.0 4291416.0 4213158.8 4021774.6 3673814.2 3409774.0 1101822   0
# 2  2011 23274888  427294.9 4218152.0 4076845.2 4002500.9 3820685.9 3490123.4 3239285   0
# 3  2012 20572019 1538196.5  405930.2 4007244.4 3873002.9 3802375.8 3629651.6 3315617   0
# 4  2013 18266554 1872972.3 1461286.6  385633.7 3806882.2 3679352.8 3612257.0 3448169   0
# 5  2014 14251615  174149.8 1779323.7 1388222.3  366352.0 3616538.1 3495385.2 3431644   0
# 6  2015 11164848  885875.0  165442.3 1690357.5 1318811.2  348034.4 3435711.2 3320616   0
# 7  2016 10081197 2629176.9  841581.3  157170.2 1605839.7 1252870.6  330632.7 3263926   0
# 8  2017  9937128 3460720.5 2497718.1  799502.2  149311.7 1525547.7 1190227.1  314101   0
# 9  2018 13032169 3890292.9 3287684.4 2372832.2  759527.1  141846.1 1449270.3 1130716   0
# 10 2019 15286105 3979724.9 3695778.3 3123300.2 2254190.6  721550.8  134753.8 1376807   0

# Case III : depop K1, change capA - equillibrium simulation ends after 3 years

# proj_Q_P_PostFMD
#   Year        Ps        Pc      EPs       EPc        Hc       Sl       Cl        A   repHeif repHeif_Head
# 1  2010 0.6011694 0.5845779 1.390661 0.7194778 0.5072427 20.53728 1.015221 21.66571 0.3619544     427294.9
# 2  2011 0.6178396 0.5737343 1.392512 0.7067025 0.5072477 19.36640 1.016800 20.49014 1.3029806    1538196.5
# 3  2012 0.6829699 0.4498377 1.405415 0.5682568 0.5072477 19.01773 1.016471 21.19644 1.5865637    1872972.3
# 4  2013 0.6753869 0.4542327 1.397100 0.5804751 0.5072431 19.01455 1.010512 21.11413 0.1988813     234783.6
# 5  2014 0.6754174 0.4534472 1.397134 0.5796556 0.5072478 19.01536 1.013121 21.11773 0.7737385     913414.9
# 6  2015 0.6934259 0.3936492 1.416859 0.5002628 0.5072481 19.01658 1.278962 21.39932 2.3733764    2801821.6
# 7  2016 0.7490858 0.2598589 1.427744 0.4002628 0.5239341 19.01394 2.143123 22.30770 3.4598502    4084427.2
# 8  2017 0.7373506 0.2665140 1.414894 0.3723644 0.5072487 19.01871 2.039444 22.20341 3.2330366    3816668.9
# 9  2018 0.7495029 0.2665212 1.428121 0.3600821 0.5072601 19.01970 2.104555 22.27311 3.2557282    3843456.8
# 10 2019 0.6185028 0.3366908 1.341112 0.4600821 0.4884301 19.01018 1.205121 21.31472 1.9923450    2352005.9
# > beefINV_FORECAST_PostFMD
#     Year        K        k3        k4        k5        k6        k7        k8      k9 k10
# 1  2010 25151920 4440160.0 4291416.0 4213158.8 4021774.6 3673814.2 3409774.0 1101822   0
# 2  2011 23274888  427294.9 4218152.0 4076845.2 4002500.9 3820685.9 3490123.4 3239285   0
# 3  2012 20572019 1538196.5  405930.2 4007244.4 3873002.9 3802375.8 3629651.6 3315617   0
# 4  2013 18266554 1872972.3 1461286.6  385633.7 3806882.2 3679352.8 3612257.0 3448169   0
# 5  2014 14312249  234783.6 1779323.7 1388222.3  366352.0 3616538.1 3495385.2 3431644   0
# 6  2015 11249989  913414.9  223044.4 1690357.5 1318811.2  348034.4 3435711.2 3320616   0
# 7  2016 10334727 2801821.6  867744.1  211892.2 1605839.7 1252870.6  330632.7 3263926   0
# 8  2017 10801688 4084427.2 2661730.5  824356.9  201297.6 1525547.7 1190227.1  314101   0
# 9  2018 13779877 3816668.9 3880205.8 2528644.0  783139.1  191232.7 1449270.3 1130716   0
# 10 2019 15860160 3843456.8 3625835.4 3686195.5 2402211.8  743982.1  181671.1 1376807   0



### 50% depopulation rate
# Case III : depop K1, change capA - equillibrium simulation continues
# > proj_Q_P_PostFMD
#     Year        Ps        Pc       EPs       EPc        Hc       Sl       Cl        A   repHeif repHeif_Head
# 1  2010 0.6399271 0.4357674 1.2809770 0.6698248 0.5072477 19.01481 1.409852 20.52423 2.8272062    3337577.4
# 2  2011 0.5630900 0.5097272 1.2104612 0.8109853 0.5072475 19.01819 1.018470 20.14149 1.9484370    2300171.5
# 3  2012 0.6339084 0.4013071 1.2235690 0.6881591 0.5072538 19.01829 1.014795 21.18582 0.5873519     693381.4
# 4  2013 0.6376485 0.4145862 1.2168243 0.7079537 0.5072400 19.01644 1.016615 21.12896 1.2850603    1517041.2
# 5  2014 0.6387914 0.3959088 1.1918031 0.7122313 0.5072495 19.01324 1.080259 21.19346 2.0673403    2440539.4
# 6  2015 0.6570177 0.3382917 1.1451999 0.6968486 0.5072478 19.01617 1.350440 21.47300 2.3531434    2777936.1
# 7  2016 0.6421967 0.2904234 1.0917610 0.6977398 0.5072311 19.01449 1.481959 21.61226 2.4529912    2895808.6
# 8  2017 0.7170552 0.3534076 0.9066756 0.9344795 0.5072478 19.01056 1.531209 21.66925 2.4480733    2890002.9
# 9  2018 0.7737401 0.4169706 0.8393967 1.0620146 0.5072474 19.01557 1.502755 21.63499 2.3931691    2825187.4
# 10 2019 0.8010093 0.4404719 0.7983684 1.1242174 0.5072476 19.01289 1.518308 21.65685 2.4070186    2841537.0
# > beefINV_FORECAST_PostFMD
#     Year        K        k3        k4        k5        k6        k7        k8        k9 k10
# 1  2010 15719950 2775100.0 2682135.0 2633224.2 2513609.2 2296133.8 2131108.8  688639.0   0
# 2  2011 17617323 3337577.4 2636345.0 2548028.2 2501563.0 2387928.7 2181327.2 2024553.3   0
# 3  2012 17113303 2300171.5 3170698.6 2504527.8 2420626.8 2376484.9 2268532.3 2072260.8   0
# 4  2013 14982371  693381.4 2185162.9 3012163.6 2379301.4 2299595.5 2257660.6 2155105.7   0
# 5  2014 13702943 1517041.2  658712.4 2075904.8 2861555.5 2260336.3 2184615.7 2144777.6   0
# 6  2015 13420797 2440539.4 1441189.1  625776.7 1972109.5 2718477.7 2147319.5 2075384.9   0
# 7  2016 13556078 2777936.1 2318512.5 1369129.7  594487.9 1873504.1 2582553.8 2039953.5   0
# 8  2017 13836126 2895808.6 2639039.3 2202586.8 1300673.2  564763.5 1779828.9 2453426.1   0
# 9  2018 13703568 2890002.9 2751018.2 2507087.3 2092457.5 1235639.5  536525.3 1690837.4   0
# 10 2019 14237282 2825187.4 2745502.7 2613467.3 2381733.0 1987834.6 1173857.6  509699.1   0

# Case III : depop K1, change capA - equillibrium simulation ends after 3 years
# proj_Q_P_PostFMD
#     Year        Ps        Pc      EPs       EPc        Hc       Sl       Cl        A   repHeif repHeif_Head
# 1  2010 0.6399271 0.4357674 1.280977 0.6698248 0.5072477 19.01481 1.409852 20.52423 2.8272062    3337577.4
# 2  2011 0.5630900 0.5097272 1.210461 0.8109853 0.5072475 19.01819 1.018470 20.14149 1.9484370    2300171.5
# 3  2012 0.6339084 0.4013071 1.223569 0.6881591 0.5072538 19.01829 1.014795 21.18582 0.5873519     693381.4
# 4  2013 0.6284789 0.4071063 1.217609 0.6995936 0.5072412 19.01103 1.011011 21.11095 1.2504674    1476203.6
# 5  2014 0.6337804 0.3725832 1.223417 0.6589738 0.5072477 19.01057 1.141444 21.24799 2.1500070    2538129.3
# 6  2015 0.6581404 0.2934478 1.247091 0.5589738 0.5082509 19.01176 1.536105 21.66537 2.6039945    3074071.2
# 7  2016 0.6489661 0.3000836 1.237043 0.5722999 0.5072477 19.01857 1.470402 21.60327 2.4372186    2877188.7
# 8  2017 0.6464312 0.3025676 1.234268 0.5774201 0.5072476 19.01035 1.449314 21.57237 2.3374999    2759468.6
# 9  2018 0.6420361 0.3060722 1.229457 0.5854808 0.5072486 19.01795 1.418117 21.54749 2.2802513    2691885.4
# 10 2019 0.6462680 0.2853136 1.234091 0.5599764 0.5072467 19.01674 1.520358 21.65401 2.4123145    2847788.9
# > beefINV_FORECAST_PostFMD
#     Year        K        k3        k4        k5        k6        k7        k8        k9 k10
# 1  2010 15719950 2775100.0 2682135.0 2633224.2 2513609.2 2296133.8 2131108.8  688639.0   0
# 2  2011 17617323 3337577.4 2636345.0 2548028.2 2501563.0 2387928.7 2181327.2 2024553.3   0
# 3  2012 17113303 2300171.5 3170698.6 2504527.8 2420626.8 2376484.9 2268532.3 2072260.8   0
# 4  2013 14982371  693381.4 2185162.9 3012163.6 2379301.4 2299595.5 2257660.6 2155105.7   0
# 5  2014 13662106 1476203.6  658712.4 2075904.8 2861555.5 2260336.3 2184615.7 2144777.6   0
# 6  2015 13479591 2538129.3 1402393.4  625776.7 1972109.5 2718477.7 2147319.5 2075384.9   0
# 7  2016 13908067 3074071.2 2411222.8 1332273.7  594487.9 1873504.1 2582553.8 2039953.5   0
# 8  2017 14151897 2877188.7 2920367.6 2290661.7 1265660.0  564763.5 1779828.9 2453426.1   0
# 9  2018 13873016 2759468.6 2733329.3 2774349.3 2176128.6 1202377.0  536525.3 1690837.4   0
# 10 2019 14264955 2691885.4 2621495.2 2596662.8 2635631.8 2067322.2 1142258.2  509699.1   0


### 90% depopulation rate
# Case III : depop K1, change capA - equillibrium simulation continues
# proj_Q_P_PostFMD
#     Year        Ps        Pc          EPs       EPc        Hc       Sl       Cl        A   repHeif repHeif_Head
# 1  2010 0.9207447 0.2966761 1.3611190046 0.4532385 0.5072487 19.01979 3.434435 22.57004 5.5626132    6566783.9
# 2  2011 0.9073372 0.3000691 0.5691213994 1.1945134 0.5072477 19.01101 3.313721 22.44228 5.2623194    6212280.6
# 3  2012 0.8419417 0.3458571 0.1905342181 1.5939228 0.5072476 19.01358 2.143857 22.35993 3.5488045    4189439.6
# 4  2013 0.6789637 0.3620897 0.0128097589 1.7760637 0.5072515 19.01102 1.342269 21.46231 2.3568765    2782343.1
# 5  2014 0.6902519 0.4679317 0.0044434891 1.8918705 0.5072554 19.01470 1.010267 21.12105 1.2071583    1425076.2
# 6  2015 0.7207674 0.4976188 0.0029909573 1.9234884 0.5072453 19.01167 1.016635 21.12056 0.5105759     602745.7
# 7  2016 0.7366759 0.5135446 0.0008619351 1.9417204 0.5072445 19.01939 1.016993 21.11853 0.5153476     608378.9
# 8  2017 0.7537477 0.5304365 0.0020963381 1.9578166 0.5072479 19.01113 1.017121 21.12072 0.8391231     990602.8
# 9  2018 0.7805096 0.5575455 0.0052233056 1.9825648 0.5072476 19.01702 1.016340 21.12024 1.0901350    1286927.7
# 10 2019 0.8378971 0.4924385 0.0022259276 1.9189159 0.5072456 19.01945 1.456558 21.58944 2.3788435    2808275.6
# > beefINV_FORECAST_PostFMD
#     Year        K        k3        k4        k5        k6        k7        k8        k9 k10
# 1  2010  3143990  555020.0  536427.0  526644.8  502721.8  459226.8  426221.8  137727.8   0
# 2  2011  9422733 6566783.9  527269.0  509605.6  500312.6  477585.7  436265.4  404910.7   0
# 3  2012 14779212 6212280.6 6238444.7  500905.5  484125.4  475297.0  453706.5  414452.2   0
# 4  2013 17835961 4189439.6 5901666.6 5926522.5  475860.3  459919.1  451532.1  431021.1   0
# 5  2014 19317036 2782343.1 3979967.6 5606583.3 5630196.4  452067.3  436923.1  428955.5   0
# 6  2015 19368753 1425076.2 2643226.0 3780969.3 5326254.1 5348686.5  429463.9  415077.0   0
# 7  2016 18608738  602745.7 1353822.4 2511064.7 3591920.8 5059941.4 5081252.2  407990.7   0
# 8  2017 17899089  608378.9  572608.5 1286131.3 2385511.4 3412324.8 4806944.3 4827189.6   0
# 9  2018 13408907  990602.8  577959.9  543978.0 1221824.7 2266235.9 3241708.5 4566597.1   0
# 10 2019  9687122 1286927.7  941072.6  549061.9  516779.1 1160733.5 2152924.1 3079623.1   0

# Case III : depop K1, change capA - equillibrium simulation ends after 3 years
# proj_Q_P_PostFMD
#     Year        Ps        Pc        EPs       EPc        Hc       Sl       Cl        A   repHeif repHeif_Head
# 1  2010 0.9207447 0.2966761 1.36111900 0.4532385 0.5072487 19.01979 3.434435 22.57004 5.5626132      6566784
# 2  2011 0.9073372 0.3000691 0.56912140 1.1945134 0.5072477 19.01101 3.313721 22.44228 5.2623194      6212281
# 3  2012 0.8419417 0.3458571 0.19053422 1.5939228 0.5072476 19.01358 2.143857 22.35993 3.5488045      4189440
# 4  2013 0.6540464 0.4260101 0.09053422 1.6939228 0.4804469 19.01544 1.015471 21.12030 1.4482064      1709639
# 5  2014 0.6510892 0.4297782 0.08730013 1.7757256 0.5072466 19.01248 1.010894 21.11235 1.0528126      1242868
# 6  2015 0.6511536 0.4292919 0.08735337 1.7751940 0.5072517 19.01326 1.012671 21.11505 0.9375703      1106822
# 7  2016 0.6512200 0.4289579 0.08742681 1.7747729 0.5072475 19.01418 1.013977 21.11739 0.9935093      1172859
# 8  2017 0.6508728 0.4293097 0.08706085 1.7754689 0.5072461 19.01941 1.012055 21.12088 1.1073331      1307230
# 9  2018 0.6509731 0.4276535 0.08717135 1.7736797 0.5072474 19.01590 1.017403 21.12282 1.1077372      1307707
# 10 2019 0.7059494 0.2962231 0.09899187 1.6736797 0.5233836 19.01351 1.741442 21.88372 2.7525123      3249400
# > beefINV_FORECAST_PostFMD
# Year        K      k3      k4        k5        k6        k7        k8        k9 k10
# 1  2010  3143990  555020  536427  526644.8  502721.8  459226.8  426221.8  137727.8   0
# 2  2011  9422733 6566784  527269  509605.6  500312.6  477585.7  436265.4  404910.7   0
# 3  2012 14779212 6212281 6238445  500905.5  484125.4  475297.0  453706.5  414452.2   0
# 4  2013 17835961 4189440 5901667 5926522.5  475860.3  459919.1  451532.1  431021.1   0
# 5  2014 18244332 1709639 3979968 5606583.3 5630196.4  452067.3  436923.1  428955.5   0
# 6  2015 18167475 1242868 1624157 3780969.3 5326254.1 5348686.5  429463.9  415077.0   0
# 7  2016 17971600 1106822 1180724 1542948.8 3591920.8 5059941.4 5081252.2  407990.7   0
# 8  2017 17858288 1172859 1051481 1121688.2 1465801.4 3412324.8 4806944.3 4827189.6   0
# 9  2018 13686774 1307230 1114216  998906.7 1065603.8 1392511.3 3241708.5 4566597.1   0
# 10 2019  9971875 1307707 1241869 1058505.2  948961.4 1012323.6 1322885.8 3079623.1   0


######### The below results are by the following assumptions
# 1. 5% Decline in domestic demand for two years
# 2. In year 3 domestic demand goes back up
# 3. Exports banned for three years
# 4. In year 4 exports ban is lifted and everything is back to normal
#### All under equillibrium simulation continues

### 20% depopulation
proj_Q_P_PostFMD_20_I <- proj_Q_P_PostFMD
beefINV_FORECAST_PostFMD_20_I <- beefINV_FORECAST_PostFMD

### 50% depopulation
proj_Q_P_PostFMD_50_I <- proj_Q_P_PostFMD
beefINV_FORECAST_PostFMD_50_I <- beefINV_FORECAST_PostFMD

### 90% depopulation
proj_Q_P_PostFMD_90_I <- proj_Q_P_PostFMD
beefINV_FORECAST_PostFMD_90_I <- beefINV_FORECAST_PostFMD



######### The below results are by the following assumptions (Optimistic case)
# 1. 5% Decline in domestic demand for 1 year
# 2. In year 2 domestic demand goes back up
# 3. Exports banned for 2 years
# 4. In year 3 exports ban is lifted and everything is back to normal
#### All under equillibrium simulation continues

### 20% depopulation
proj_Q_P_PostFMD_20_II <- proj_Q_P_PostFMD
beefINV_FORECAST_PostFMD_20_II <- beefINV_FORECAST_PostFMD

### 50% depopulation
proj_Q_P_PostFMD_50_II <- proj_Q_P_PostFMD
beefINV_FORECAST_PostFMD_50_II <- beefINV_FORECAST_PostFMD

### 90% depopulation
proj_Q_P_PostFMD_90_II <- proj_Q_P_PostFMD
beefINV_FORECAST_PostFMD_90_II <- beefINV_FORECAST_PostFMD



######### The below results are by the following assumptions (Pessimistic scenario)
# 1. 5% Decline in domestic demand for 3 years
# 2. In year 4 domestic demand goes back up
# 3. Exports banned for 5 years
# 4. In year 6 exports ban is lifted and everything is back to normal
#### All under equillibrium simulation continues

### 20% depopulation 
proj_Q_P_PostFMD_20_III <- proj_Q_P_PostFMD
beefINV_FORECAST_PostFMD_20_III <- beefINV_FORECAST_PostFMD

### 50% depopulation
proj_Q_P_PostFMD_50_III <- proj_Q_P_PostFMD
beefINV_FORECAST_PostFMD_50_III <- beefINV_FORECAST_PostFMD

### 90% depopulation
proj_Q_P_PostFMD_90_III <- proj_Q_P_PostFMD
beefINV_FORECAST_PostFMD_90_III <- beefINV_FORECAST_PostFMD



###################### Here I merge the optimistic case prices under all depopulation levels

proj_Q_P_PostFMD_20_OP <- proj_Q_P_PostFMD_20_II
proj_Q_P_PostFMD_20_OP <- proj_Q_P_PostFMD_20_OP %>% select(Year, Ps, Pc) %>% transmute(Year = Year,
                                                                                        Ps20 = Ps,
                                                                                        Pc20 = Pc)
proj_Q_P_PostFMD_50_OP <- proj_Q_P_PostFMD_50_II
proj_Q_P_PostFMD_50_OP <- proj_Q_P_PostFMD_50_OP %>% select(Year, Ps, Pc) %>% transmute(Year = Year,
                                                                                        Ps50 = Ps,
                                                                                        Pc50 = Pc)

proj_Q_P_PostFMD_90_OP <- proj_Q_P_PostFMD_90_II
proj_Q_P_PostFMD_90_OP <- proj_Q_P_PostFMD_90_OP %>% select(Year, Ps, Pc) %>% transmute(Year = Year,
                                                                                        Ps90 = Ps,
                                                                                        Pc90 = Pc)

optPriceList <- list(proj_Q_P_PostFMD_20_OP, proj_Q_P_PostFMD_50_OP, proj_Q_P_PostFMD_90_OP)
optPricePostFMD <- Reduce(function(...) merge(...), optPriceList)


beefINV_FORECAST_PostFMD_20_OP <- beefINV_FORECAST_PostFMD_20_II
beefINV_FORECAST_PostFMD_20_OP <- beefINV_FORECAST_PostFMD_20_OP %>% select(Year, K) %>% transmute(Year = Year,
                                                                                        K20 = K)
beefINV_FORECAST_PostFMD_50_OP <- beefINV_FORECAST_PostFMD_50_II
beefINV_FORECAST_PostFMD_50_OP <- beefINV_FORECAST_PostFMD_50_OP %>% select(Year, K) %>% transmute(Year = Year,
                                                                                                   K50 = K)

beefINV_FORECAST_PostFMD_90_OP <- beefINV_FORECAST_PostFMD_90_II
beefINV_FORECAST_PostFMD_90_OP <- beefINV_FORECAST_PostFMD_90_OP %>% select(Year, K) %>% transmute(Year = Year,
                                                                                                   K90 = K)

optStockList <- list(beefINV_FORECAST_PostFMD_20_OP, beefINV_FORECAST_PostFMD_50_OP, beefINV_FORECAST_PostFMD_90_OP)
optStockPostFMD <- Reduce(function(...) merge(...), optStockList)



###################### Here I merge the pessimistic case prices under all depopulation levels

proj_Q_P_PostFMD_20_PE <- proj_Q_P_PostFMD_20_III
proj_Q_P_PostFMD_20_PE <- proj_Q_P_PostFMD_20_PE %>% select(Year, Ps, Pc) %>% transmute(Year = Year,
                                                                                        Ps20 = Ps,
                                                                                        Pc20 = Pc)
proj_Q_P_PostFMD_50_PE <- proj_Q_P_PostFMD_50_III
proj_Q_P_PostFMD_50_PE <- proj_Q_P_PostFMD_50_PE %>% select(Year, Ps, Pc) %>% transmute(Year = Year,
                                                                                        Ps50 = Ps,
                                                                                        Pc50 = Pc)

proj_Q_P_PostFMD_90_PE <- proj_Q_P_PostFMD_90_III
proj_Q_P_PostFMD_90_PE <- proj_Q_P_PostFMD_90_PE %>% select(Year, Ps, Pc) %>% transmute(Year = Year,
                                                                                        Ps90 = Ps,
                                                                                        Pc90 = Pc)

pePriceList <- list(proj_Q_P_PostFMD_20_PE, proj_Q_P_PostFMD_50_PE, proj_Q_P_PostFMD_90_PE)
pePricePostFMD <- Reduce(function(...) merge(...), pePriceList)


beefINV_FORECAST_PostFMD_20_PE <- beefINV_FORECAST_PostFMD_20_III
beefINV_FORECAST_PostFMD_20_PE <- beefINV_FORECAST_PostFMD_20_PE %>% select(Year, K) %>% transmute(Year = Year,
                                                                                                   K20 = K)
beefINV_FORECAST_PostFMD_50_PE <- beefINV_FORECAST_PostFMD_50_III
beefINV_FORECAST_PostFMD_50_PE <- beefINV_FORECAST_PostFMD_50_PE %>% select(Year, K) %>% transmute(Year = Year,
                                                                                                   K50 = K)

beefINV_FORECAST_PostFMD_90_PE <- beefINV_FORECAST_PostFMD_90_III
beefINV_FORECAST_PostFMD_90_PE <- beefINV_FORECAST_PostFMD_90_PE %>% select(Year, K) %>% transmute(Year = Year,
                                                                                                   K90 = K)

peStockList <- list(beefINV_FORECAST_PostFMD_20_PE, beefINV_FORECAST_PostFMD_50_PE, beefINV_FORECAST_PostFMD_90_PE)
peStockPostFMD <- Reduce(function(...) merge(...), peStockList)



############################ Plotting ############

obsPrices <- pc_ps %>% filter(Year > (optPricePostFMD$Year[1] - 3))

### Optimistic scenario prices
optPrices <- left_join(obsPrices, optPricePostFMD) %>% filter(Year <= optPricePostFMD$Year[nrow(optPricePostFMD)])


optPricesPlot <- optPrices %>% ggplot(aes(x=Year)) + geom_line(aes(y=ps, color="PS OBS"))+ 
  geom_point(aes(y=ps, color = "PS OBS")) + geom_line(aes(y=Ps20, color="PS DEPOP 20"))+ 
  geom_point(aes(y=Ps20, color="PS DEPOP 20")) + geom_line(aes(y=Ps50, color="PS DEPOP 50"))+ 
  geom_point(aes(y=Ps50, color="PS DEPOP 50")) + geom_line(aes(y=Ps90, color="PS DEPOP 90"))+ 
  geom_point(aes(y=Ps90, color="PS DEPOP 90")) + 
  scale_x_continuous(name="Year", 
                     breaks=c(seq(optPrices$Year[1],
                                  optPrices$Year[nrow(optPrices)]))) 


### Pessimistic scenario prices
pePrices <- left_join(obsPrices, pePricePostFMD) %>% filter(Year <= pePricePostFMD$Year[nrow(pePricePostFMD)])


pePricesPlot <- pePrices %>% ggplot(aes(x=Year)) + geom_line(aes(y=ps, color="PS OBS"))+ 
  geom_point(aes(y=ps, color = "PS OBS")) + geom_line(aes(y=Ps20, color="PS DEPOP 20"))+ 
  geom_point(aes(y=Ps20, color="PS DEPOP 20")) + geom_line(aes(y=Ps50, color="PS DEPOP 50"))+ 
  geom_point(aes(y=Ps50, color="PS DEPOP 50")) + geom_line(aes(y=Ps90, color="PS DEPOP 90"))+ 
  geom_point(aes(y=Ps90, color="PS DEPOP 90")) + 
  scale_x_continuous(name="Year", 
                     breaks=c(seq(pePrices$Year[1],
                                  pePrices$Year[nrow(pePrices)]))) 




