#### Notes:

#### This contains the output we get for different iterations of the code

# if(i > 1){
#   if(quantities_prices_capK$ps[i] < quantities_prices_capK$ps[i-1]){
#     ps <- (quantities_prices_capK$ps[i] + quantities_prices_capK$ps[i-1] + quantities_prices_capK$ps[i-2] + quantities_prices_capK$ps[i-3])/4
#   }
#   if(quantities_prices_capK$pc[i] < quantities_prices_capK$pc[i-1]){
#     pc <- (quantities_prices_capK$pc[i] + quantities_prices_capK$pc[i-1] + quantities_prices_capK$pc[i-2] + quantities_prices_capK$pc[i-3])/4
#   }
# }



pricePS <- unique(round(prices_ps[,6],6)) %>% as.data.frame()
names(pricePS) <- "ps"
# mean(pricePS$ps)
ggplot(data = pricePS, aes(x=ps)) + geom_density()


pricePC <- unique(round(prices_pc[,6],6)) %>% as.data.frame()
names(pricePC) <- "pc"
ggplot(data = pricePC, aes(x=pc)) + geom_density()



# longPC = melt(pricePC)
# 
# ggplot(longPC, aes (x=value, colour = variable)) + geom_density()



fedPrice[[15]][,22]
# estObsPS
#     Year  fedPrice        ps         err
# 1  2001 0.8538038 0.7496667 -0.10413710
# 2  2002 0.8866983 0.7012500 -0.18544833
# 3  2003 0.9326645 0.8450000 -0.08766446
# 4  2004 0.9552903 0.8968333 -0.05845693
# 5  2005 0.9243137 0.9408333  0.01651964
# 6  2006 1.0157784 0.9204167 -0.09536170
# 7  2007 1.0549331 0.9538333 -0.10109977
# 8  2008 1.0834636 0.9446667 -0.13879698
# 9  2009 1.0592527 0.8533333 -0.20591939
# 10 2010 1.0880931 0.9723333 -0.11575972
# 11 2011 1.0853018 1.1716667  0.08636486
# 12 2012 1.0751020 1.2308333  0.15573128
# 13 2013 1.1100763 1.2633333  0.15325705
# 14 2014 1.2528118 1.5433333  0.29052154
# 15 2015 1.3006753 1.4933333  0.19265800
# 16 2016 0.0000000 1.2166667  1.21666667
# 17 2017 0.0000000 1.2191667  1.21916667

# estObsPS
# Year  fedPrice        ps          err
# 1  2001 0.7375044 0.7496667  0.012162233
# 2  2002 0.7743388 0.7012500 -0.073088791
# 3  2003 0.8257720 0.8450000  0.019228049
# 4  2004 0.8529269 0.8968333  0.043906398
# 5  2005 0.8075346 0.9408333  0.133298699
# 6  2006 0.9264059 0.9204167 -0.005989199
# 7  2007 0.9677925 0.9538333 -0.013959179
# 8  2008 0.9997110 0.9446667 -0.055044345
# 9  2009 0.9803703 0.8533333 -0.127036956
# 10 2010 1.0058695 0.9723333 -0.033536215
# 11 2011 1.0010681 1.1716667  0.170598547
# 12 2012 0.9306459 1.2308333  0.300187399
# 13 2013 1.0159299 1.2633333  0.247403480
# 14 2014 1.1620369 1.5433333  0.381296412
# 15 2015 1.2008565 1.4933333  0.292476873
# 16 2016 0.0000000 1.2166667  1.216666667
# 17 2017 0.0000000 1.2191667  1.219166667




# estObsPC
#     Year cullPrice        pc            D
# 1  2001 0.3838507 0.4100000 -0.026149319
# 2  2002 0.3963374 0.3741667  0.022170701
# 3  2003 0.4234339 0.4295833 -0.006149396
# 4  2004 0.4542183 0.5055000 -0.051281690
# 5  2005 0.4207697 0.5205833 -0.099813632
# 6  2006 0.4734011 0.4674167  0.005984437
# 7  2007 0.5496863 0.4811667  0.068519631
# 8  2008 0.5645966 0.5080000  0.056596638
# 9  2009 0.5304602 0.4485000  0.081960184
# 10 2010 0.5249031 0.5493333 -0.024430207
# 11 2011 0.5520989 0.7157500 -0.163651054
# 12 2012 0.5181352 0.8197500 -0.301614813
# 13 2013 0.5933913 0.8229167 -0.229525390
# 14 2014 0.7598927 1.0822500 -0.322357278
# 15 2015 0.8640919 1.0410833 -0.176991444
# 16 2016 0.0000000 0.7489167 -0.748916667
# 17 2017 0.0000000 0.6955833 -0.695583333

# estObsPC
#     Year cullPrice        pc           D
# 1  2001 0.3895823 0.4100000 -0.02041766
# 2  2002 0.2698450 0.3741667 -0.10432171
# 3  2003 0.2969181 0.4295833 -0.13266518
# 4  2004 0.3277467 0.5055000 -0.17775332
# 5  2005 0.2918671 0.5205833 -0.22871628
# 6  2006 0.3472754 0.4674167 -0.12014124
# 7  2007 0.4231971 0.4811667 -0.05796961
# 8  2008 0.4382734 0.5080000 -0.06972665
# 9  2009 0.3848860 0.4485000 -0.06361399
# 10 2010 0.3987376 0.5493333 -0.15059575
# 11 2011 0.4256428 0.7157500 -0.29010724
# 12 2012 0.3659728 0.8197500 -0.45377724
# 13 2013 0.4666660 0.8229167 -0.35625063
# 14 2014 0.6335134 1.0822500 -0.44873659
# 15 2015 0.7373956 1.0410833 -0.30368770
# 16 2016 0.0000000 0.7489167 -0.74891667
# 17 2017 0.0000000 0.6955833 -0.69558333


t1 <- merge(supp_sl, newSL) %>% drop_na() %>% select(Year, Bill_meatLb_sl, slLbs) %>%
  mutate(differences = Bill_meatLb_sl - slLbs)

t2 <- merge(supp_sl, newSL) %>% drop_na() %>% select(Year, Bill_meatLb_sl, slLbs) %>%
  mutate(differences = Bill_meatLb_sl - slLbs)





fedPrice[[1]][, colSums(fedPrice[[1]])>0]




# estObsPS
# Year  fedPrice        ps         err
# 1  2001 0.8245711 0.7496667 -0.07490441
# 2  2002 0.8574066 0.7012500 -0.15615659
# 3  2003 0.9045583 0.8450000 -0.05955834
# 4  2004 0.9295274 0.8968333 -0.03269411
# 5  2005 0.9079469 0.9408333  0.03288641
# 6  2006 1.0002179 0.9204167 -0.07980127
# 7  2007 1.0312447 0.9538333 -0.07741133
# 8  2008 1.0642732 0.9446667 -0.11960656
# 9  2009 1.0482245 0.8533333 -0.19489112
# 10 2010 1.0770874 0.9723333 -0.10475407
# 11 2011 0.0000000 1.1716667  1.17166667
# 12 2012 0.0000000 1.2308333  1.23083333
# 13 2013 0.0000000 1.2633333  1.26333333
# 14 2014 0.0000000 1.5433333  1.54333333
# 15 2015 0.0000000 1.4933333  1.49333333
# 16 2016 0.0000000 1.2166667  1.21666667
# 17 2017 0.0000000 1.2191667  1.21916667

# estObsPC
# Year cullPrice        pc            D
# 1  2001 0.4111786 0.4100000  0.001178571
# 2  2002 0.4235952 0.3741667  0.049428571
# 3  2003 0.4505952 0.4295833  0.021011905
# 4  2004 0.4814286 0.5055000 -0.024071429
# 5  2005 0.4592063 0.5205833 -0.061376984
# 6  2006 0.5010119 0.4674167  0.033595238
# 7  2007 0.5769286 0.4811667  0.095761905
# 8  2008 0.5920120 0.5080000  0.084011986
# 9  2009 0.5692619 0.4485000  0.120761905
# 10 2010 0.5525952 0.5493333  0.003261905
# 11 2011 0.0000000 0.7157500 -0.715750000
# 12 2012 0.0000000 0.8197500 -0.819750000
# 13 2013 0.0000000 0.8229167 -0.822916667
# 14 2014 0.0000000 1.0822500 -1.082250000
# 15 2015 0.0000000 1.0410833 -1.041083333
# 16 2016 0.0000000 0.7489167 -0.748916667
# 17 2017 0.0000000 0.6955833 -0.695583333



